<!-- Summary Button (hidden, triggered via FAB) -->
<button class="summary-button" (click)="openSummary()">
  <span class="icon">S</span>
</button>

<!-- Summary Modal -->
<div class="summary-modal" *ngIf="showSummary">
  <div class="modal-content">
    <div class="modal-header">
      <h2>
        <span class="english">Conversation Summary</span>
        <span class="hebrew">סיכום שיחה</span>
      </h2>
      <button class="close-button" (click)="onClose()">x</button>
    </div>

    <!-- Stats bar -->
    <div class="summary-stats">
      <div class="stat">
        <span class="stat-value">{{messageCount}}</span>
        <span class="stat-label">Messages</span>
      </div>
      <div class="stat">
        <span class="stat-value">{{summaryBlocks.length}}</span>
        <span class="stat-label">Tips</span>
      </div>
      <div class="stat">
        <span class="stat-value">{{correctionCount}}</span>
        <span class="stat-label">Corrections</span>
      </div>
    </div>

    <div class="modal-body">
      <div class="summary-block {{block.type}}" *ngFor="let block of summaryBlocks; trackBy: trackByIndex">
        <div class="block-header">
          <span class="block-type-badge {{block.type}}" [innerHTML]="getTypeIcon(block.type)"></span>
          <span class="block-title">{{block.title}}</span>
          <span class="block-type-label">{{getTypeLabel(block.type)}}</span>
        </div>

        <div class="block-body">
          <div class="english" dir="ltr">{{block.english}}</div>
          <div class="hebrew" dir="rtl" *ngIf="block.hebrew">{{block.hebrew}}</div>
        </div>

        <div class="block-examples" *ngIf="block.examples?.length">
          <div class="example" *ngFor="let ex of block.examples; trackBy: trackByIndex">
            <div class="english" dir="ltr">{{ex.english}}</div>
            <div class="hebrew" dir="rtl" *ngIf="ex.hebrew">{{ex.hebrew}}</div>
          </div>
        </div>
      </div>

      <div class="no-content" *ngIf="summaryBlocks.length === 0">
        <span class="english">No learning points found yet. Keep chatting!</span>
        <span class="hebrew">עדיין לא נמצאו נקודות למידה. המשיכו לשוחח!</span>
      </div>
    </div>
  </div>
</div>
